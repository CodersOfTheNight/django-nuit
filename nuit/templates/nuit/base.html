{% load static %}
{% load compress %}
<!doctype html>

<html class='no-js' lang='en'>

<head>
    <meta charset='utf-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>{% block title %}{{page_title|default:NUIT_APP_TITLE}}{% endblock %}</title>

    {% compress css %}
    <link rel='stylesheet' type='text/x-scss' href='{% static 'app.scss' %}' />
    {% endcompress %}

    <link rel='stylesheet' type='text/css' href='{% static 'icons/foundation-icons.css' %}' />

    <script src='{% static 'js/vendor/modernizr.js' %}'></script>

</head>
<body>

    {% if nuit_topbar %}
    {% include 'nuit/includes/_top_bar.html' %}
    {% endif %}

    <section role='main'>
    <div class='row clearfix'>
        {% if nuit_leftmenu %}
        {% include 'nuit/includes/_left_menu_open.html' %}
        {% block left_menu %}{% endblock %}
        {% include 'nuit/includes/_left_menu_close.html' %}
        {% endif %}
        {% if nuit_rightmenu %}
        {% include 'nuit/includes/_right_menu_open.html' %}
        {% block right_menu %}{% endblock %}
        {% include 'nuit/includes/_right_menu_close.html' %}
        {% endif %}
        <div class='main'>
        </div>
    </div>
    </section>

    <script src='{% static 'js/jquery.js' %}'></script>
    <script src='{% static 'js/foundation.min.js' %}'></script>
    <script>

    function pad_main() {
        var left_width = $('.sidebar.left').outerWidth();
        var left_padding = 0;
        if (left_width > 40) {
            left_padding = left_width + 10;
        }
        $('.main').css({
            'paddingLeft': left_padding
        });
    }

    $(window).resize(pad_main);
    pad_main();

    $('.nuit-active-menu').each(function() {
        $('.menu-' + $(this).html()).addClass('active');
    });

    $('.sidebar.right > section').each(function() {
        $this = $(this);
        if ($this.data('link')) {
            $('body').append("<div id='" + $this.data('id') + "' class='reveal-modal' data-reveal><a class='close-reveal-modal'><i class='fi-x size-16'></i></a>" + $this.find('div').html() + '</div>');
            $('#right-menu-drop').append("<li><a href='#' data-reveal-id='" + $this.data('id') + "'>" + $this.data('link') + "</a></li>");
        } else {
            $nav = $this.find('nav');
            if ($nav.length) {
                $nav.find('ul li').each(function() {
                    $li = $(this);
                    $('#right-menu-drop').append($li.clone());
                });
            }
        }
    });

    $('.sidebar.left > section').each(function() {
        $this = $(this);
        $nav = $this.find('nav');
        if ($nav.length) {
            $title = $this.find('h5');
            $append_to = $('#left-menu-drop');
            if ($title.length) {
                $new_li = $('<li></li>').addClass('show-for-small-only').addClass('has-dropdown')
                $new_li.append("<a href='#'>" + $title.html() + "</a>");
                $append_to.append($new_li);
                $new_ul = $("<ul class='dropdown'></ul>");
                $new_li.append($new_ul);
                $append_to = $new_ul;
            }
            $nav.find('ul li').each(function() {
                $li = $(this);
                $append_to.append($li.clone().addClass('show-for-small-only'));
            });
            $('#left-menu-drop').append("<li class='show-for-small-only divider'></li>");
        }
    });

    $(document).foundation();

    </script>
    
</body>

</html>
